const express = require("express");
const luckyDrawController = require("../controllers/luckyDrawControllers");
const auth = require("../middleware/auth");
const router = express.Router();
const multer = require("multer");
// Set up multer storage
const storage = multer.memoryStorage();
const upload = multer({ storage: storage });

////////////////////////////////
//   CREATE LUCKY DRAW
///////////////////////////////
router.route("/create").post(auth, luckyDrawController.createLuckyDraw);


//////////////////////////////////////////////////////////
///////// UPLOAD IMAGE TO LUCKYDRAW /////////////////////
////////////////////////////////////////////////////////
router.route("/upload-image").post(auth, upload.single("file"), luckyDrawController.addImageToPrize);



////////////////////////////////////////
// GET ALL LUCKY DRAW//////////////////
/////////////////////////////////////
router.route("/all").get(auth, luckyDrawController.getAllLuckyDraws);


///////////////////////////////////////////////////////////////
//// GET WINNER OF THE COMPLETED LUCKY DRAW////
///////////////////////////////////////////////////////////////
router.route("/winnerStats/all").get(auth, luckyDrawController.getWinnerStatistics);





///////////////////////////////////////////////////////////////
//// GET STAT OF THE LUCKY DRAW////
///////////////////////////////////////////////////////////////
router.route("/stats").get(auth, luckyDrawController.getLuckyDrawStats);



////////////////////////////////////////////
//// GET LUCK DRAW BY ID///////////////////
///////////////////////////////////////////
router.route("/:id").get(auth, luckyDrawController.getLuckyDrawById);


////////////////////////////////////////////
//// UPDATE LUCK DRAW//////////////////////
///////////////////////////////////////////
router.route("/:id").put(auth, luckyDrawController.updateLuckyDraw);


////////////////////////////////
//// EXECUTE LUCK DRAW//////////
///////////////////////////////
router.route("/:id/execute").post(auth, luckyDrawController.executeLuckyDraw);

////////////////////////////////////
//// GET USER LUCK DRAW HISTORY////
//////////////////////////////////
router.route("/user/history").get(auth, luckyDrawController.getUserLuckyDrawHistory);

///////////////////////////////////////
//// GET USER UPCOMING LUCK DRAW//////
/////////////////////////////////////
router.route("/user/upcoming").get(auth, luckyDrawController.getUserUpcomingLuckyDraws);


////////////////////////////////////////
//// GET ELIGIBLE USER OF LUCK DRAW////
///////////////////////////////////////
router.route("/:id/eligible-users").get(auth, luckyDrawController.getEligibleUsers);

///////////////////////////////////////
//// CANCEL A SCHEDULED LUCK DRAW////
///////////////////////////////////////
router.route("/:id/cancel").post(auth, luckyDrawController.cancelLuckyDraw);

///////////////////////////////////////////////////////////////
//// RESCHDULE A LUCK DRAW////
///////////////////////////////////////////////////////////////
router.route("/:id/reschedule").post(auth, luckyDrawController.rescheduleLuckyDraw);

///////////////////////////////////////////////////////////////
//// GET WINNER OF THE COMPLETED LUCKY DRAW////
///////////////////////////////////////////////////////////////
router.route("/:id/winner").get(auth, luckyDrawController.getLuckyDrawWinners);


///////////////////////////////////////////////////////////////
//// GET WINNER OF THE COMPLETED LUCKY DRAW////
///////////////////////////////////////////////////////////////
router.route("/:id/winner").get(auth, luckyDrawController.getLuckyDrawWinners);

///////////////////////////////////////////////////////////////
//// DELETE API////
///////////////////////////////////////////////////////////////
router.route("/:id").delete(auth, luckyDrawController.removeLuckyDraw);



module.exports = router;
