const express = require("express");
const userController = require("../controllers/userControllers");
const authentication = require("../middleware/auth");
const router = express.Router();
const multer = require("multer");
// Set up multer storage
const storage = multer.memoryStorage();
const upload = multer({ storage: storage });


/////////////////////////////////////////////
///////// SIGNUP USER //////////////////////
///////////////////////////////////////////
router.route("/signup").post(upload.single("image"), userController.signupUser);

/////////////////////////////////////////////
///////// LOGIN USER ///////////////////////
///////////////////////////////////////////
router.route("/login").post(userController.signinUser);

/////////////////////////////////////////////
///////// GET ALL USER LIST ////////////////
///////////////////////////////////////////
router.route("/").get(authentication, userController.allUser);

/////////////////////////////////////////////
///////// GET SINGLE USER //////////////////
///////////////////////////////////////////
router.route("/single/:id").get(authentication, userController.signleUser);

/////////////////////////////////////////////
///////// REMOVE USER //////////////////////
///////////////////////////////////////////
router.route("/:id").delete(authentication, userController.removeUser);

/////////////////////////////////////////////
///////// UPDATE USER //////////////////////
///////////////////////////////////////////
router.route("/:id").put(authentication,upload.single("image"), userController.updateUser);

/////////////////////////////////////////////
///////// FORGOT PASSWORD //////////////////
///////////////////////////////////////////
router.route("/forgot-password").post(userController.forgotPassword);

/////////////////////////////////////////////
///////// VERIFY CODE //////////////////////
///////////////////////////////////////////
router.route("/verify-code").post(userController.verifyCode);

/////////////////////////////////////////////
///////// VERIFY CODE //////////////////////
///////////////////////////////////////////
router.route("/update-password").post(userController.updateUserPassword);

/////////////////////////////////////////////////
///////// GET STAT OF USER BY MONTH ////////////
///////////////////////////////////////////////

// we can call it also like this /api/user/get-user-stat?year=2024 - Get stats for 2024
router.route("/get-user-stat").get(authentication, userController.getStatByMonthUser);



module.exports = router;
